# -*- coding: utf-8 -*-
"""XGBoost ML

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1PnxOezZDVRhVt_BpyfNloQG7gVY43rFa
"""

pip install xgboost

from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error,r2_score
from xgboost import XGBRegressor

data=fetch_california_housing(as_frame=True)

x=data.data
y=data.target

x

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42)

model=XGBRegressor(n_estimators=100,learning_rate=0.1,max_depth=3,subsample=0.8,colsample_bytree=0.8,random_state=42)

model.fit(x_train,y_train)

y_pred=model.predict(x_test)

mse=mean_squared_error(y_test,y_pred)
r2=r2_score(y_test,y_pred)
print(mse)

r2

print(f"the mse is {mse}")

print(f"the mse is {mse:.2f}")

print(f"the r2 is {r2:.2f}")

import kagglehub
import pandas as pd

# Download latest version
path = kagglehub.dataset_download("maajdl/yeh-concret-data")

print("Path to dataset files:", path)

import os
import pandas as pd
df=pd.read_csv(os.path.join(path, 'Concrete_Data_Yeh.csv'))

df

import matplotlib.pyplot as plt
import seaborn as sns

for i in df.columns[:-1]:
  sns.boxplot(df[i])
  plt.title(i)
  plt.show()

# so we are check the correlation
plt.figure(figsize=(10,10))
sns.heatmap(df.corr(),annot=True)

for i in df.columns[:-1]:
  df[i] = df[i].clip(lower=df[i].quantile(0.25),upper=df[i].quantile(0.75))

for i in df.columns[:-1]:
  sns.boxplot(df[i])
  plt.title(i)
  plt.show()

df

df.info()

x=df[['cement','slag','flyash','water','superplasticizer','coarseaggregate','fineaggregate','age']]
y=df['csMPa']

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42)

model=XGBRegressor(n_estimators=100,learning_rate=0.1,max_depth=3,subsample=0.8,colsample_bytree=0.8,random_state=42)

model.fit(x_train,y_train)

y_pred=model.predict(x_test)

mse=mean_squared_error(y_test,y_pred)
r2=r2_score(y_test,y_pred)
print(mse)

r2

r2_score(y_test,model.predict(x_test))

df

model.predict([[200,92,120,150,2.6,850,925,40]])

import pickle
with open("model.pkl", "wb") as file:
    pickle.dump(model, file)